{"version":3,"file":"index.js","sources":["../src/utils/uuid.ts","../src/core/services/report.ts","../src/core/errors/js-errors.ts","../src/core/errors/promise-errors.ts","../src/core/errors/ajax-errors.ts","../src/core/errors/resource-errors.ts","../src/core/errors/vue-errors.ts","../src/core/errors/index.ts","../src/core/performance/index.ts","../src/core/trace/xhr-interceptor.ts","../src/core/trace/fetch-interceptor.ts","../src/core/trace/index.ts","../src/core/monitor.ts","../src/index.ts","../src/core/legacy.ts"],"sourcesContent":["const UUID_RADIX = 16;\nconst UUID_MASK_3 = 0x3;\nconst UUID_MASK_8 = 0x8;\n\nexport function generateUUID(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c: string): string => {\n    const r = (Math.random() * UUID_RADIX) | 0;\n    const v = c === 'x' ? r : (r & UUID_MASK_3) | UUID_MASK_8;\n    return v.toString(UUID_RADIX);\n  });\n}\n","import { ErrorInfo, PerformanceData, SegmentFields } from '../types';\n\nconst ERROR_STATUS_CODE = 400;\nexport class ReportService {\n  private buildURL(type: string, collector: string): string {\n    const paths: Record<string, string> = {\n      ERROR: '/error',\n      ERRORS: '/errors',\n      PERF: '/perf',\n      SEGMENT: '/segment',\n      SEGMENTS: '/segments',\n    };\n    return `${collector}${paths[type] || ''}`;\n  }\n\n  sendError(error: ErrorInfo): void {\n    const url = this.buildURL('ERROR', error.collector);\n    this.sendByFetch(url, error);\n  }\n\n  sendPerformance(perf: PerformanceData): void {\n    const url = this.buildURL('PERF', perf.collector);\n    this.sendByFetch(url, perf);\n  }\n\n  sendSegments(segments: SegmentFields[]): void {\n    const url = this.buildURL('SEGMENTS', segments[0]?.service || '');\n    this.sendByFetch(url, segments);\n  }\n\n  sendSegmentsByBeacon(segments: SegmentFields[]): void {\n    const url = this.buildURL('SEGMENTS', segments[0]?.service || '');\n    this.sendByBeacon(url, segments);\n  }\n\n  private sendByFetch(url: string, data: unknown): void {\n    if (!url) return;\n\n    fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        if (response.status >= ERROR_STATUS_CODE) {\n          throw new Error(`Request failed with status ${response.status}`);\n        }\n      })\n      .catch((error) => {\n        console.warn('Report error:', error);\n      });\n  }\n\n  private sendByBeacon(url: string, data: unknown): void {\n    if (!url) return;\n\n    if (typeof navigator.sendBeacon === 'function') {\n      navigator.sendBeacon(url, new Blob([JSON.stringify(data)], { type: 'application/json' }));\n    } else {\n      this.sendByFetch(url, data);\n    }\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class JSErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    window.addEventListener('error', this.handleError.bind(this));\n    this.enabled = true;\n  }\n\n  disable(): void {\n    window.removeEventListener('error', this.handleError.bind(this));\n    this.enabled = false;\n  }\n\n  private handleError(event: ErrorEvent): void {\n    const errorInfo: ErrorInfo = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      category: 'JS_ERROR',\n      grade: 'ERROR',\n      errorUrl: event.filename || window.location.href,\n      message: event.message,\n      collector: this.options.collector,\n      stack: event.error?.stack,\n    };\n\n    this.reportService.sendError(errorInfo);\n  }\n\n  capture(error: Error, context?: Partial<ErrorInfo>): void {\n    const errorInfo: ErrorInfo = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      category: 'JS_ERROR',\n      grade: 'ERROR',\n      errorUrl: window.location.href,\n      message: error.message,\n      collector: this.options.collector,\n      stack: error.stack,\n      ...context,\n    };\n\n    this.reportService.sendError(errorInfo);\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class PromiseErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    window.addEventListener('unhandledrejection', this.handleRejection.bind(this));\n    this.enabled = true;\n  }\n\n  disable(): void {\n    window.removeEventListener('unhandledrejection', this.handleRejection.bind(this));\n    this.enabled = false;\n  }\n\n  private handleRejection(event: PromiseRejectionEvent): void {\n    const errorInfo: ErrorInfo = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      category: 'PROMISE_ERROR',\n      grade: 'ERROR',\n      errorUrl: window.location.href,\n      message: event.reason?.message || 'Unhandled Promise Rejection',\n      collector: this.options.collector,\n      stack: event.reason?.stack,\n    };\n\n    this.reportService.sendError(errorInfo);\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nconst ERROR_STATUS_CODE = 400;\ninterface XHRWithMetadata extends XMLHttpRequest {\n  _method?: string;\n  _url?: string;\n}\n\nexport class AjaxErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    this.interceptXHR();\n    this.interceptFetch();\n    this.enabled = true;\n  }\n\n  disable(): void {\n    this.enabled = false;\n  }\n\n  private interceptXHR(): void {\n    const originalOpen = XMLHttpRequest.prototype.open;\n    const originalSend = XMLHttpRequest.prototype.send;\n    const reportService = this.reportService;\n\n    XMLHttpRequest.prototype.open = function (\n      this: XHRWithMetadata,\n      method: string,\n      url: string | URL,\n      async: boolean = true,\n      user: string | null = null,\n      password: string | null = null\n    ): void {\n      this._method = method;\n      this._url = url.toString();\n      originalOpen.call(this, method, url, async, user, password);\n    };\n\n    XMLHttpRequest.prototype.send = function (\n      this: XHRWithMetadata,\n      body?: Document | XMLHttpRequestBodyInit | null\n    ): void {\n      this.addEventListener('load', () => {\n        if (this.status >= ERROR_STATUS_CODE) {\n          const errorInfo: ErrorInfo = {\n            uniqueId: generateUUID(),\n            service: 'apm-client',\n            serviceVersion: '1.0.0',\n            pagePath: window.location.pathname,\n            category: 'AJAX_ERROR',\n            grade: 'ERROR',\n            errorUrl: this._url ?? '',\n            message: `Status: ${this.status}`,\n            collector: 'http://localhost:12800',\n          };\n          reportService.sendError(errorInfo);\n        }\n      });\n      originalSend.call(this, body);\n    };\n  }\n\n  private interceptFetch(): void {\n    const originalFetch = window.fetch;\n    const reportService = this.reportService;\n\n    window.fetch = async function (\n      input: RequestInfo | URL,\n      init?: RequestInit\n    ): Promise<Response> {\n      const response = await originalFetch.call(window, input, init);\n\n      if (response.status >= ERROR_STATUS_CODE) {\n        const errorInfo: ErrorInfo = {\n          uniqueId: generateUUID(),\n          service: 'apm-client',\n          serviceVersion: '1.0.0',\n          pagePath: window.location.pathname,\n          category: 'AJAX_ERROR',\n          grade: 'ERROR',\n          errorUrl: response.url,\n          message: `Status: ${response.status}`,\n          collector: 'http://localhost:12800',\n        };\n        reportService.sendError(errorInfo);\n      }\n\n      return response;\n    };\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class ResourceErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    window.addEventListener('error', this.handleError.bind(this), true);\n    this.enabled = true;\n  }\n\n  disable(): void {\n    window.removeEventListener('error', this.handleError.bind(this), true);\n    this.enabled = false;\n  }\n\n  private handleError(event: Event): void {\n    const target = event.target as HTMLElement;\n\n    if (target instanceof HTMLScriptElement) {\n      const errorInfo: ErrorInfo = {\n        uniqueId: generateUUID(),\n        service: this.options.service,\n        serviceVersion: this.options.serviceVersion,\n        pagePath: this.options.pagePath,\n        category: 'RESOURCE_ERROR',\n        grade: 'ERROR',\n        errorUrl: target.src || window.location.href,\n        message: `Resource load error: ${target.tagName}`,\n        collector: this.options.collector,\n      };\n\n      this.reportService.sendError(errorInfo);\n    } else if (target instanceof HTMLLinkElement) {\n      const errorInfo: ErrorInfo = {\n        uniqueId: generateUUID(),\n        service: this.options.service,\n        serviceVersion: this.options.serviceVersion,\n        pagePath: this.options.pagePath,\n        category: 'RESOURCE_ERROR',\n        grade: 'ERROR',\n        errorUrl: target.href || window.location.href,\n        message: `Resource load error: ${target.tagName}`,\n        collector: this.options.collector,\n      };\n\n      this.reportService.sendError(errorInfo);\n    } else if (target instanceof HTMLImageElement) {\n      const errorInfo: ErrorInfo = {\n        uniqueId: generateUUID(),\n        service: this.options.service,\n        serviceVersion: this.options.serviceVersion,\n        pagePath: this.options.pagePath,\n        category: 'RESOURCE_ERROR',\n        grade: 'ERROR',\n        errorUrl: target.src || window.location.href,\n        message: `Resource load error: ${target.tagName}`,\n        collector: this.options.collector,\n      };\n\n      this.reportService.sendError(errorInfo);\n    }\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo, VueInstance } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class VueErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(vue: VueInstance): void {\n    if (this.enabled) return;\n\n    if (vue && vue.config) {\n      vue.config.errorHandler = (error: Error, _vm: unknown, info: string) => {\n        const errorInfo: ErrorInfo = {\n          uniqueId: generateUUID(),\n          service: this.options.service,\n          serviceVersion: this.options.serviceVersion,\n          pagePath: this.options.pagePath,\n          category: 'VUE_ERROR',\n          grade: 'ERROR',\n          errorUrl: window.location.href,\n          message: info,\n          collector: this.options.collector,\n          stack: error.stack,\n        };\n\n        this.reportService.sendError(errorInfo);\n      };\n    }\n\n    this.enabled = true;\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { JSErrors } from './js-errors';\nimport { PromiseErrors } from './promise-errors';\nimport { AjaxErrors } from './ajax-errors';\nimport { ResourceErrors } from './resource-errors';\nimport { VueErrors } from './vue-errors';\n\nexport class ErrorTracker {\n  private options: ErrorTrackingOptions;\n  private jsErrors: JSErrors;\n  private promiseErrors: PromiseErrors;\n  private ajaxErrors: AjaxErrors;\n  private resourceErrors: ResourceErrors;\n  private vueErrors: VueErrors;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.jsErrors = new JSErrors(options);\n    this.promiseErrors = new PromiseErrors(options);\n    this.ajaxErrors = new AjaxErrors(options);\n    this.resourceErrors = new ResourceErrors(options);\n    this.vueErrors = new VueErrors(options);\n  }\n\n  enable(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n\n    if (options.jsErrors ?? false) {\n      this.jsErrors.enable();\n      this.promiseErrors.enable();\n      if (options.vue) {\n        this.vueErrors.enable(options.vue);\n      }\n    }\n\n    if (options.apiErrors ?? false) {\n      this.ajaxErrors.enable();\n    }\n\n    if (options.resourceErrors ?? false) {\n      this.resourceErrors.enable();\n    }\n  }\n\n  capture(error: Error, context?: Partial<ErrorInfo>): void {\n    this.jsErrors.capture(error, context);\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n    this.jsErrors.updateConfig(options);\n    this.promiseErrors.updateConfig(options);\n    this.ajaxErrors.updateConfig(options);\n    this.resourceErrors.updateConfig(options);\n    this.vueErrors.updateConfig(options);\n  }\n}\n","import { PerformanceTrackingOptions, PerformanceData } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class PerformanceTracker {\n  private options: PerformanceTrackingOptions;\n  private reportService: ReportService;\n\n  constructor(options: PerformanceTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  track(): void {\n    if (document.readyState === 'complete') {\n      this.collectAndReport();\n    } else {\n      window.addEventListener('load', () => this.collectAndReport(), { once: true });\n    }\n  }\n\n  private collectAndReport(): void {\n    if (!(this.options.autoTracePerf ?? false)) return;\n\n    const performanceData: PerformanceData = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      collector: this.options.collector,\n      timing: performance.timing,\n    };\n\n    if (this.options.useFmp ?? false) {\n      performanceData.fmpTime = this.calculateFMP();\n    }\n\n    this.reportService.sendPerformance(performanceData);\n  }\n\n  private calculateFMP(): number {\n    return 0;\n  }\n\n  updateConfig(options: PerformanceTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { TraceTrackingOptions } from '../types';\n\nexport class XHRInterceptor {\n  constructor() {}\n\n  enable(): void {\n    // TODO: Implement XHR interception logic\n  }\n\n  disable(): void {\n    // TODO: Implement XHR cleanup logic\n  }\n\n  updateConfig(_options: TraceTrackingOptions): void {\n    // TODO: Implement config update logic\n  }\n}\n","import { TraceTrackingOptions } from '../types';\n\nexport class FetchInterceptor {\n  constructor() {}\n\n  enable(): void {\n    // TODO: Implement Fetch interception logic\n  }\n\n  disable(): void {\n    // TODO: Implement Fetch cleanup logic\n  }\n\n  updateConfig(_options: TraceTrackingOptions): void {\n    // TODO: Implement config update logic\n  }\n}\n","import { TraceTrackingOptions, SegmentFields, TagOption } from '../types';\nimport { XHRInterceptor } from './xhr-interceptor';\nimport { FetchInterceptor } from './fetch-interceptor';\nimport { ReportService } from '../services/report';\n\nexport class TraceTracker {\n  private options: TraceTrackingOptions;\n  private segments: SegmentFields[] = [];\n  private xhrInterceptor: XHRInterceptor;\n  private fetchInterceptor: FetchInterceptor;\n  private reportService: ReportService;\n  private timer: number | null = null;\n\n  constructor(options: TraceTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n    this.xhrInterceptor = new XHRInterceptor();\n    this.fetchInterceptor = new FetchInterceptor();\n  }\n\n  enable(options: TraceTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n    this.xhrInterceptor.enable();\n    this.fetchInterceptor.enable();\n    this.setupReportTimer();\n    this.setupUnloadHandler();\n  }\n\n  disable(): void {\n    this.xhrInterceptor.disable();\n    this.fetchInterceptor.disable();\n    this.clearReportTimer();\n  }\n\n  private setupReportTimer(): void {\n    if (this.timer != null) clearInterval(this.timer);\n\n    this.timer = window.setInterval(() => {\n      if (this.segments.length > 0) {\n        this.reportService.sendSegments([...this.segments]);\n        this.segments.splice(0, this.segments.length);\n      }\n    }, this.options.traceTimeInterval ?? 60000);\n  }\n\n  private clearReportTimer(): void {\n    if (this.timer != null) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n  }\n\n  private setupUnloadHandler(): void {\n    window.addEventListener('beforeunload', () => {\n      if (this.segments.length > 0) {\n        this.reportService.sendSegmentsByBeacon([...this.segments]);\n      }\n    });\n  }\n\n  setCustomTags(tags: TagOption[]): void {\n    this.options.customTags = tags;\n    this.xhrInterceptor.updateConfig(this.options);\n    this.fetchInterceptor.updateConfig(this.options);\n  }\n\n  updateConfig(options: TraceTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n    this.xhrInterceptor.updateConfig(this.options);\n    this.fetchInterceptor.updateConfig(this.options);\n  }\n}\n","import {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n  ErrorInfo,\n} from './types';\nimport { ErrorTracker } from './errors';\nimport { PerformanceTracker } from './performance';\nimport { TraceTracker } from './trace';\n\nexport type { APMOptions, TagOption };\n\nexport class APMClient {\n  private options: APMOptions;\n  private errorTracker: ErrorTracker;\n  private performanceTracker: PerformanceTracker;\n  private traceTracker: TraceTracker;\n\n  constructor(options?: Partial<APMOptions>) {\n    this.options = {\n      collector: typeof window !== 'undefined' ? window.location.origin : '',\n      service: '',\n      serviceVersion: '',\n      pagePath: typeof window !== 'undefined' ? window.location.pathname : '',\n      ...options,\n    };\n\n    this.errorTracker = new ErrorTracker(this.options);\n    this.performanceTracker = new PerformanceTracker(this.options);\n    this.traceTracker = new TraceTracker(this.options);\n  }\n\n  init(\n    options: APMOptions & ErrorTrackingOptions & PerformanceTrackingOptions & TraceTrackingOptions\n  ): void {\n    this.options = { ...this.options, ...options };\n    this.validateOptions();\n\n    if (\n      (options.jsErrors ?? false) ||\n      (options.apiErrors ?? false) ||\n      (options.resourceErrors ?? false)\n    ) {\n      this.errorTracker.enable(options);\n    }\n\n    if ((options.autoTracePerf ?? false) && !(options.enableSPA ?? false)) {\n      this.performanceTracker.track();\n    }\n\n    this.traceTracker.enable(options);\n  }\n\n  updateConfig(options: Partial<APMOptions>): void {\n    this.options = { ...this.options, ...options };\n    this.errorTracker.updateConfig(this.options);\n    this.performanceTracker.updateConfig(this.options);\n    this.traceTracker.updateConfig(this.options);\n  }\n\n  captureError(error: Error, context?: Partial<ErrorInfo>): void {\n    this.errorTracker.capture(error, context);\n  }\n\n  trackPerformance(options?: Partial<PerformanceTrackingOptions>): void {\n    if (options) {\n      this.updateConfig(options);\n    }\n    this.performanceTracker.track();\n  }\n\n  setCustomTags(tags: TagOption[]): void {\n    if (this.validateTags(tags)) {\n      this.traceTracker.setCustomTags(tags);\n    }\n  }\n\n  private validateOptions(): void {\n    const { collector, service, pagePath, serviceVersion } = this.options;\n\n    if (typeof collector !== 'string') {\n      this.options.collector = typeof window !== 'undefined' ? window.location.origin : '';\n    }\n    if (typeof service !== 'string') {\n      this.options.service = '';\n    }\n    if (typeof pagePath !== 'string') {\n      this.options.pagePath = typeof window !== 'undefined' ? window.location.pathname : '';\n    }\n    if (typeof serviceVersion !== 'string') {\n      this.options.serviceVersion = '';\n    }\n  }\n\n  private validateTags(tags?: TagOption[]): boolean {\n    if (!tags) {\n      return false;\n    }\n    if (!Array.isArray(tags)) {\n      console.warn('customTags must be an array');\n      return false;\n    }\n    const isValid = tags.every(\n      (tag) => tag && typeof tag.key === 'string' && typeof tag.value === 'string'\n    );\n    if (!isValid) {\n      console.warn('customTags format error');\n    }\n    return isValid;\n  }\n\n  getOptions(): Readonly<APMOptions> {\n    return this.options;\n  }\n}\n","import { createLegacyClient } from './core/legacy';\nimport { APMClient } from './core/monitor';\nimport {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n} from './core/types';\n\nconst ClientMonitor = createLegacyClient();\n\nif (typeof window !== 'undefined') {\n  (window as any).ClientMonitor = ClientMonitor;\n}\n\nexport default ClientMonitor;\n\nexport { APMClient };\nexport type {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n};\n","import { APMClient } from './monitor';\nimport {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n  VueInstance,\n} from './types';\n\nexport interface LegacyOptions\n  extends APMOptions, ErrorTrackingOptions, PerformanceTrackingOptions, TraceTrackingOptions {\n  vue?: VueInstance;\n}\n\nexport function createLegacyClient() {\n  const client = new APMClient();\n\n  const legacyClient = {\n    customOptions: {} as LegacyOptions,\n\n    register(configs: LegacyOptions): void {\n      this.customOptions = { ...this.customOptions, ...configs };\n      client.init(configs);\n    },\n\n    setPerformance(configs: PerformanceTrackingOptions): void {\n      this.customOptions = { ...this.customOptions, ...configs, useFmp: false };\n      client.updateConfig(this.customOptions);\n      client.trackPerformance(this.customOptions);\n    },\n\n    catchErrors(options: ErrorTrackingOptions): void {\n      const { service, pagePath, serviceVersion, collector } = options;\n      const errorOptions: ErrorTrackingOptions = {\n        ...options,\n        service: service || this.customOptions.service,\n        pagePath: pagePath || this.customOptions.pagePath,\n        serviceVersion: serviceVersion || this.customOptions.serviceVersion,\n        collector: collector || this.customOptions.collector,\n      };\n      client.init(errorOptions);\n    },\n\n    reportFrameErrors(configs: APMOptions, error: Error): void {\n      client.captureError(error, {\n        service: configs.service,\n        pagePath: configs.pagePath,\n        serviceVersion: configs.serviceVersion,\n        collector: configs.collector,\n      });\n    },\n\n    setCustomTags(tags: TagOption[]): void {\n      if (this.validateTags(tags)) {\n        this.customOptions.customTags = tags;\n        client.setCustomTags(tags);\n      }\n    },\n\n    validateTags(customTags?: TagOption[]): boolean {\n      if (!customTags) {\n        return false;\n      }\n      if (!Array.isArray(customTags)) {\n        this.customOptions.customTags = undefined;\n        console.warn('customTags error');\n        return false;\n      }\n      let isValid = true;\n      for (const tag of customTags) {\n        if (!(tag && tag.key && tag.value)) {\n          isValid = false;\n        }\n      }\n      if (!isValid) {\n        this.customOptions.customTags = undefined;\n        console.warn('customTags error');\n      }\n      return isValid;\n    },\n\n    validateOptions(): void {\n      const {\n        collector,\n        service,\n        pagePath,\n        serviceVersion,\n        jsErrors,\n        apiErrors,\n        resourceErrors,\n        autoTracePerf,\n        useFmp,\n        enableSPA,\n        traceSDKInternal,\n        detailMode,\n        noTraceOrigins,\n        traceTimeInterval,\n        vue,\n      } = this.customOptions;\n\n      this.validateTags(this.customOptions.customTags);\n\n      if (typeof collector !== 'string') {\n        this.customOptions.collector = typeof window !== 'undefined' ? window.location.origin : '';\n      }\n      if (typeof service !== 'string') {\n        this.customOptions.service = '';\n      }\n      if (typeof pagePath !== 'string') {\n        this.customOptions.pagePath = typeof window !== 'undefined' ? window.location.pathname : '';\n      }\n      if (typeof serviceVersion !== 'string') {\n        this.customOptions.serviceVersion = '';\n      }\n      if (typeof jsErrors !== 'boolean') {\n        this.customOptions.jsErrors = true;\n      }\n      if (typeof apiErrors !== 'boolean') {\n        this.customOptions.apiErrors = true;\n      }\n      if (typeof resourceErrors !== 'boolean') {\n        this.customOptions.resourceErrors = true;\n      }\n      if (typeof autoTracePerf !== 'boolean') {\n        this.customOptions.autoTracePerf = true;\n      }\n      if (typeof useFmp !== 'boolean') {\n        this.customOptions.useFmp = false;\n      }\n      if (typeof enableSPA !== 'boolean') {\n        this.customOptions.enableSPA = false;\n      }\n      if (typeof traceSDKInternal !== 'boolean') {\n        this.customOptions.traceSDKInternal = false;\n      }\n      if (typeof detailMode !== 'boolean') {\n        this.customOptions.detailMode = true;\n      }\n      if (!Array.isArray(noTraceOrigins)) {\n        this.customOptions.noTraceOrigins = [];\n      }\n      if (typeof traceTimeInterval !== 'number') {\n        this.customOptions.traceTimeInterval = 60000;\n      }\n      if (typeof vue !== 'function') {\n        this.customOptions.vue = undefined;\n      }\n    },\n\n    performance(configs: PerformanceTrackingOptions): void {\n      client.trackPerformance(configs);\n    },\n  };\n\n  return legacyClient;\n}\n"],"names":["generateUUID","replace","c","r","Math","random","toString","ReportService","buildURL","type","collector","ERROR","ERRORS","PERF","SEGMENT","SEGMENTS","sendError","error","url","this","sendByFetch","sendPerformance","perf","sendSegments","segments","_a","service","sendSegmentsByBeacon","sendByBeacon","data","fetch","method","headers","body","JSON","stringify","then","response","status","Error","catch","console","warn","navigator","sendBeacon","Blob","JSErrors","constructor","options","enabled","reportService","enable","window","addEventListener","handleError","bind","disable","removeEventListener","event","errorInfo","uniqueId","serviceVersion","pagePath","category","grade","errorUrl","filename","location","href","message","stack","capture","context","updateConfig","PromiseErrors","handleRejection","reason","_b","AjaxErrors","interceptXHR","interceptFetch","originalOpen","XMLHttpRequest","prototype","open","originalSend","send","async","user","password","_method","_url","call","pathname","originalFetch","input","init","ResourceErrors","target","HTMLScriptElement","src","tagName","HTMLLinkElement","HTMLImageElement","VueErrors","vue","config","errorHandler","_vm","info","ErrorTracker","jsErrors","promiseErrors","ajaxErrors","resourceErrors","vueErrors","apiErrors","PerformanceTracker","track","document","readyState","collectAndReport","once","autoTracePerf","performanceData","timing","performance","useFmp","fmpTime","calculateFMP","XHRInterceptor","_options","FetchInterceptor","TraceTracker","timer","xhrInterceptor","fetchInterceptor","setupReportTimer","setupUnloadHandler","clearReportTimer","clearInterval","setInterval","length","splice","traceTimeInterval","setCustomTags","tags","customTags","APMClient","origin","errorTracker","performanceTracker","traceTracker","validateOptions","enableSPA","captureError","trackPerformance","validateTags","Array","isArray","isValid","every","tag","key","value","getOptions","ClientMonitor","client","customOptions","register","configs","setPerformance","catchErrors","errorOptions","reportFrameErrors","traceSDKInternal","detailMode","noTraceOrigins","createLegacyClient"],"mappings":"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"}