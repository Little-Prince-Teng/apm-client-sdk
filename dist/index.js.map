{"version":3,"file":"index.js","sources":["../src/utils/uuid.ts","../src/core/services/report.ts","../src/core/errors/js-errors.ts","../src/core/errors/promise-errors.ts","../src/core/errors/ajax-errors.ts","../src/core/errors/resource-errors.ts","../src/core/errors/vue-errors.ts","../src/core/errors/index.ts","../src/core/performance/index.ts","../src/core/trace/xhr-interceptor.ts","../src/core/trace/fetch-interceptor.ts","../src/core/trace/index.ts","../src/core/monitor.ts","../src/index.ts","../src/core/legacy.ts"],"sourcesContent":["const UUID_RADIX = 16;\nconst UUID_MASK_3 = 0x3;\nconst UUID_MASK_8 = 0x8;\n\nexport function generateUUID(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c: string): string => {\n    const r = (Math.random() * UUID_RADIX) | 0;\n    const v = c === 'x' ? r : (r & UUID_MASK_3) | UUID_MASK_8;\n    return v.toString(UUID_RADIX);\n  });\n}\n","import { ErrorInfo, PerformanceData, SegmentFields } from '../types';\n\nconst ERROR_STATUS_CODE = 400;\nexport class ReportService {\n  private buildURL(type: string, collector: string): string {\n    const paths: Record<string, string> = {\n      ERROR: '/error',\n      ERRORS: '/errors',\n      PERF: '/perf',\n      SEGMENT: '/segment',\n      SEGMENTS: '/segments',\n    };\n    return `${collector}${paths[type] || ''}`;\n  }\n\n  sendError(error: ErrorInfo): void {\n    const url = this.buildURL('ERROR', error.collector);\n    this.sendByFetch(url, error);\n  }\n\n  sendPerformance(perf: PerformanceData): void {\n    const url = this.buildURL('PERF', perf.collector);\n    this.sendByFetch(url, perf);\n  }\n\n  sendSegments(segments: SegmentFields[]): void {\n    const url = this.buildURL('SEGMENTS', segments[0]?.service || '');\n    this.sendByFetch(url, segments);\n  }\n\n  sendSegmentsByBeacon(segments: SegmentFields[]): void {\n    const url = this.buildURL('SEGMENTS', segments[0]?.service || '');\n    this.sendByBeacon(url, segments);\n  }\n\n  private sendByFetch(url: string, data: unknown): void {\n    if (!url) return;\n\n    fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    })\n      .then((response) => {\n        if (response.status >= ERROR_STATUS_CODE) {\n          throw new Error(`Request failed with status ${response.status}`);\n        }\n      })\n      .catch((error) => {\n        console.warn('Report error:', error);\n      });\n  }\n\n  private sendByBeacon(url: string, data: unknown): void {\n    if (!url) return;\n\n    if (typeof navigator.sendBeacon === 'function') {\n      navigator.sendBeacon(url, new Blob([JSON.stringify(data)], { type: 'application/json' }));\n    } else {\n      this.sendByFetch(url, data);\n    }\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class JSErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    window.addEventListener('error', this.handleError.bind(this));\n    this.enabled = true;\n  }\n\n  disable(): void {\n    window.removeEventListener('error', this.handleError.bind(this));\n    this.enabled = false;\n  }\n\n  private handleError(event: ErrorEvent): void {\n    const errorInfo: ErrorInfo = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      category: 'JS_ERROR',\n      grade: 'ERROR',\n      errorUrl: event.filename || window.location.href,\n      message: event.message,\n      collector: this.options.collector,\n      stack: event.error?.stack,\n    };\n\n    this.reportService.sendError(errorInfo);\n  }\n\n  capture(error: Error, context?: Partial<ErrorInfo>): void {\n    const errorInfo: ErrorInfo = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      category: 'JS_ERROR',\n      grade: 'ERROR',\n      errorUrl: window.location.href,\n      message: error.message,\n      collector: this.options.collector,\n      stack: error.stack,\n      ...context,\n    };\n\n    this.reportService.sendError(errorInfo);\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class PromiseErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    window.addEventListener('unhandledrejection', this.handleRejection.bind(this));\n    this.enabled = true;\n  }\n\n  disable(): void {\n    window.removeEventListener('unhandledrejection', this.handleRejection.bind(this));\n    this.enabled = false;\n  }\n\n  private handleRejection(event: PromiseRejectionEvent): void {\n    const errorInfo: ErrorInfo = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      category: 'PROMISE_ERROR',\n      grade: 'ERROR',\n      errorUrl: window.location.href,\n      message: event.reason?.message || 'Unhandled Promise Rejection',\n      collector: this.options.collector,\n      stack: event.reason?.stack,\n    };\n\n    this.reportService.sendError(errorInfo);\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\ninterface ExtendedXMLHttpRequest extends XMLHttpRequest {\n  _apmMethod?: string;\n  _apmUrl?: string;\n  _apmStartTime?: number;\n}\n\nexport class AjaxErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n  private originalXHROpen: typeof XMLHttpRequest.prototype.open | null = null;\n  private originalXHRSend: typeof XMLHttpRequest.prototype.send | null = null;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    this.interceptXHR();\n    this.enabled = true;\n  }\n\n  disable(): void {\n    if (!this.enabled) return;\n\n    this.restoreXHR();\n    this.enabled = false;\n  }\n\n  private interceptXHR(): void {\n    const self = this;\n\n    this.originalXHROpen = XMLHttpRequest.prototype.open;\n    this.originalXHRSend = XMLHttpRequest.prototype.send;\n\n    XMLHttpRequest.prototype.open = function(\n      method: string,\n      url: string | URL,\n      async?: boolean,\n      username?: string | null,\n      password?: string | null\n    ) {\n      const xhr = this as ExtendedXMLHttpRequest;\n      xhr._apmMethod = method;\n      xhr._apmUrl = url.toString();\n      xhr._apmStartTime = Date.now();\n      return self.originalXHROpen!.call(this, method, url, async ?? false, username, password);\n    };\n\n    XMLHttpRequest.prototype.send = function(body?: XMLHttpRequestBodyInit | Document | null) {\n      const xhr = this as ExtendedXMLHttpRequest;\n\n      xhr.addEventListener('error', function() {\n        const errorInfo: ErrorInfo = {\n          uniqueId: generateUUID(),\n          service: self.options.service,\n          serviceVersion: self.options.serviceVersion,\n          pagePath: self.options.pagePath,\n          category: 'AJAX_ERROR',\n          grade: 'ERROR',\n          errorUrl: xhr._apmUrl || window.location.href,\n          message: `AJAX request failed: ${xhr._apmMethod} ${xhr._apmUrl}`,\n          collector: self.options.collector,\n          stack: undefined,\n        };\n\n        self.reportService.sendError(errorInfo);\n      });\n\n      xhr.addEventListener('timeout', function() {\n        const errorInfo: ErrorInfo = {\n          uniqueId: generateUUID(),\n          service: self.options.service,\n          serviceVersion: self.options.serviceVersion,\n          pagePath: self.options.pagePath,\n          category: 'AJAX_ERROR',\n          grade: 'ERROR',\n          errorUrl: xhr._apmUrl || window.location.href,\n          message: `AJAX request timeout: ${xhr._apmMethod} ${xhr._apmUrl}`,\n          collector: self.options.collector,\n          stack: undefined,\n        };\n\n        self.reportService.sendError(errorInfo);\n      });\n\n      return self.originalXHRSend!.call(this, body);\n    };\n  }\n\n  private restoreXHR(): void {\n    if (this.originalXHROpen) {\n      XMLHttpRequest.prototype.open = this.originalXHROpen;\n    }\n    if (this.originalXHRSend) {\n      XMLHttpRequest.prototype.send = this.originalXHRSend;\n    }\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class ResourceErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n\n    window.addEventListener('error', this.handleError.bind(this), true);\n    this.enabled = true;\n  }\n\n  disable(): void {\n    window.removeEventListener('error', this.handleError.bind(this), true);\n    this.enabled = false;\n  }\n\n  private handleError(event: Event): void {\n    const target = event.target as HTMLElement;\n\n    if (target instanceof HTMLScriptElement) {\n      const errorInfo: ErrorInfo = {\n        uniqueId: generateUUID(),\n        service: this.options.service,\n        serviceVersion: this.options.serviceVersion,\n        pagePath: this.options.pagePath,\n        category: 'RESOURCE_ERROR',\n        grade: 'ERROR',\n        errorUrl: target.src || window.location.href,\n        message: `Resource load error: ${target.tagName}`,\n        collector: this.options.collector,\n      };\n\n      this.reportService.sendError(errorInfo);\n    } else if (target instanceof HTMLLinkElement) {\n      const errorInfo: ErrorInfo = {\n        uniqueId: generateUUID(),\n        service: this.options.service,\n        serviceVersion: this.options.serviceVersion,\n        pagePath: this.options.pagePath,\n        category: 'RESOURCE_ERROR',\n        grade: 'ERROR',\n        errorUrl: target.href || window.location.href,\n        message: `Resource load error: ${target.tagName}`,\n        collector: this.options.collector,\n      };\n\n      this.reportService.sendError(errorInfo);\n    } else if (target instanceof HTMLImageElement) {\n      const errorInfo: ErrorInfo = {\n        uniqueId: generateUUID(),\n        service: this.options.service,\n        serviceVersion: this.options.serviceVersion,\n        pagePath: this.options.pagePath,\n        category: 'RESOURCE_ERROR',\n        grade: 'ERROR',\n        errorUrl: target.src || window.location.href,\n        message: `Resource load error: ${target.tagName}`,\n        collector: this.options.collector,\n      };\n\n      this.reportService.sendError(errorInfo);\n    }\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo, VueInstance } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class VueErrors {\n  private options: ErrorTrackingOptions;\n  private reportService: ReportService;\n  private enabled: boolean = false;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  enable(vue: VueInstance): void {\n    if (this.enabled) return;\n\n    if (vue && vue.config) {\n      vue.config.errorHandler = (error: Error, _vm: unknown, info: string) => {\n        const errorInfo: ErrorInfo = {\n          uniqueId: generateUUID(),\n          service: this.options.service,\n          serviceVersion: this.options.serviceVersion,\n          pagePath: this.options.pagePath,\n          category: 'VUE_ERROR',\n          grade: 'ERROR',\n          errorUrl: window.location.href,\n          message: info,\n          collector: this.options.collector,\n          stack: error.stack,\n        };\n\n        this.reportService.sendError(errorInfo);\n      };\n    }\n\n    this.enabled = true;\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { ErrorTrackingOptions, ErrorInfo } from '../types';\nimport { JSErrors } from './js-errors';\nimport { PromiseErrors } from './promise-errors';\nimport { AjaxErrors } from './ajax-errors';\nimport { ResourceErrors } from './resource-errors';\nimport { VueErrors } from './vue-errors';\n\nexport class ErrorTracker {\n  private options: ErrorTrackingOptions;\n  private jsErrors: JSErrors;\n  private promiseErrors: PromiseErrors;\n  private ajaxErrors: AjaxErrors;\n  private resourceErrors: ResourceErrors;\n  private vueErrors: VueErrors;\n\n  constructor(options: ErrorTrackingOptions) {\n    this.options = options;\n    this.jsErrors = new JSErrors(options);\n    this.promiseErrors = new PromiseErrors(options);\n    this.ajaxErrors = new AjaxErrors(options);\n    this.resourceErrors = new ResourceErrors(options);\n    this.vueErrors = new VueErrors(options);\n  }\n\n  enable(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n\n    if (options.jsErrors ?? false) {\n      this.jsErrors.enable();\n      this.promiseErrors.enable();\n      if (options.vue) {\n        this.vueErrors.enable(options.vue);\n      }\n    }\n\n    if (options.apiErrors ?? false) {\n      this.ajaxErrors.enable();\n    }\n\n    if (options.resourceErrors ?? false) {\n      this.resourceErrors.enable();\n    }\n  }\n\n  capture(error: Error, context?: Partial<ErrorInfo>): void {\n    this.jsErrors.capture(error, context);\n  }\n\n  updateConfig(options: ErrorTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n    this.jsErrors.updateConfig(options);\n    this.promiseErrors.updateConfig(options);\n    this.ajaxErrors.updateConfig(options);\n    this.resourceErrors.updateConfig(options);\n    this.vueErrors.updateConfig(options);\n  }\n}\n","import { PerformanceTrackingOptions, PerformanceData } from '../types';\nimport { generateUUID } from '../../utils/uuid';\nimport { ReportService } from '../services/report';\n\nexport class PerformanceTracker {\n  private options: PerformanceTrackingOptions;\n  private reportService: ReportService;\n\n  constructor(options: PerformanceTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n  }\n\n  track(): void {\n    if (document.readyState === 'complete') {\n      this.collectAndReport();\n    } else {\n      window.addEventListener('load', () => this.collectAndReport(), { once: true });\n    }\n  }\n\n  private collectAndReport(): void {\n    if (!(this.options.autoTracePerf ?? false)) return;\n\n    const performanceData: PerformanceData = {\n      uniqueId: generateUUID(),\n      service: this.options.service,\n      serviceVersion: this.options.serviceVersion,\n      pagePath: this.options.pagePath,\n      collector: this.options.collector,\n      timing: performance.timing,\n    };\n\n    if (this.options.useFmp ?? false) {\n      performanceData.fmpTime = this.calculateFMP();\n    }\n\n    this.reportService.sendPerformance(performanceData);\n  }\n\n  private calculateFMP(): number {\n    return 0;\n  }\n\n  updateConfig(options: PerformanceTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n  }\n}\n","import { TraceTrackingOptions } from '../types';\n\nexport class XHRInterceptor {\n  constructor() {}\n\n  enable(): void {\n    // TODO: Implement XHR interception logic\n  }\n\n  disable(): void {\n    // TODO: Implement XHR cleanup logic\n  }\n\n  updateConfig(_options: TraceTrackingOptions): void {\n    // TODO: Implement config update logic\n  }\n}\n","import { TraceTrackingOptions } from '../types';\n\nexport class FetchInterceptor {\n  constructor() {}\n\n  enable(): void {\n    // TODO: Implement Fetch interception logic\n  }\n\n  disable(): void {\n    // TODO: Implement Fetch cleanup logic\n  }\n\n  updateConfig(_options: TraceTrackingOptions): void {\n    // TODO: Implement config update logic\n  }\n}\n","import { TraceTrackingOptions, SegmentFields, TagOption } from '../types';\nimport { XHRInterceptor } from './xhr-interceptor';\nimport { FetchInterceptor } from './fetch-interceptor';\nimport { ReportService } from '../services/report';\n\nexport class TraceTracker {\n  private options: TraceTrackingOptions;\n  private segments: SegmentFields[] = [];\n  private xhrInterceptor: XHRInterceptor;\n  private fetchInterceptor: FetchInterceptor;\n  private reportService: ReportService;\n  private timer: number | null = null;\n\n  constructor(options: TraceTrackingOptions) {\n    this.options = options;\n    this.reportService = new ReportService();\n    this.xhrInterceptor = new XHRInterceptor();\n    this.fetchInterceptor = new FetchInterceptor();\n  }\n\n  enable(options: TraceTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n    this.xhrInterceptor.enable();\n    this.fetchInterceptor.enable();\n    this.setupReportTimer();\n    this.setupUnloadHandler();\n  }\n\n  disable(): void {\n    this.xhrInterceptor.disable();\n    this.fetchInterceptor.disable();\n    this.clearReportTimer();\n  }\n\n  private setupReportTimer(): void {\n    if (this.timer != null) clearInterval(this.timer);\n\n    this.timer = window.setInterval(() => {\n      if (this.segments.length > 0) {\n        this.reportService.sendSegments([...this.segments]);\n        this.segments.splice(0, this.segments.length);\n      }\n    }, this.options.traceTimeInterval ?? 60000);\n  }\n\n  private clearReportTimer(): void {\n    if (this.timer != null) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n  }\n\n  private setupUnloadHandler(): void {\n    window.addEventListener('beforeunload', () => {\n      if (this.segments.length > 0) {\n        this.reportService.sendSegmentsByBeacon([...this.segments]);\n      }\n    });\n  }\n\n  setCustomTags(tags: TagOption[]): void {\n    this.options.customTags = tags;\n    this.xhrInterceptor.updateConfig(this.options);\n    this.fetchInterceptor.updateConfig(this.options);\n  }\n\n  updateConfig(options: TraceTrackingOptions): void {\n    this.options = { ...this.options, ...options };\n    this.xhrInterceptor.updateConfig(this.options);\n    this.fetchInterceptor.updateConfig(this.options);\n  }\n}\n","import {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n  ErrorInfo,\n} from './types';\nimport { ErrorTracker } from './errors';\nimport { PerformanceTracker } from './performance';\nimport { TraceTracker } from './trace';\n\nexport type { APMOptions, TagOption };\n\nexport class APMClient {\n  private options: APMOptions;\n  private errorTracker: ErrorTracker;\n  private performanceTracker: PerformanceTracker;\n  private traceTracker: TraceTracker;\n\n  constructor(options?: Partial<APMOptions>) {\n    this.options = {\n      collector: typeof window !== 'undefined' ? window.location.origin : '',\n      service: '',\n      serviceVersion: '',\n      pagePath: typeof window !== 'undefined' ? window.location.pathname : '',\n      ...options,\n    };\n\n    this.errorTracker = new ErrorTracker(this.options);\n    this.performanceTracker = new PerformanceTracker(this.options);\n    this.traceTracker = new TraceTracker(this.options);\n  }\n\n  init(\n    options: APMOptions & ErrorTrackingOptions & PerformanceTrackingOptions & TraceTrackingOptions\n  ): void {\n    this.options = { ...this.options, ...options };\n    this.validateOptions();\n\n    if (\n      (options.jsErrors ?? false) ||\n      (options.apiErrors ?? false) ||\n      (options.resourceErrors ?? false)\n    ) {\n      this.errorTracker.enable(options);\n    }\n\n    if ((options.autoTracePerf ?? false) && !(options.enableSPA ?? false)) {\n      this.performanceTracker.track();\n    }\n\n    this.traceTracker.enable(options);\n  }\n\n  updateConfig(options: Partial<APMOptions>): void {\n    this.options = { ...this.options, ...options };\n    this.errorTracker.updateConfig(this.options);\n    this.performanceTracker.updateConfig(this.options);\n    this.traceTracker.updateConfig(this.options);\n  }\n\n  captureError(error: Error, context?: Partial<ErrorInfo>): void {\n    this.errorTracker.capture(error, context);\n  }\n\n  trackPerformance(options?: Partial<PerformanceTrackingOptions>): void {\n    if (options) {\n      this.updateConfig(options);\n    }\n    this.performanceTracker.track();\n  }\n\n  setCustomTags(tags: TagOption[]): void {\n    if (this.validateTags(tags)) {\n      this.traceTracker.setCustomTags(tags);\n    }\n  }\n\n  private validateOptions(): void {\n    const { collector, service, pagePath, serviceVersion } = this.options;\n\n    if (typeof collector !== 'string') {\n      this.options.collector = typeof window !== 'undefined' ? window.location.origin : '';\n    }\n    if (typeof service !== 'string') {\n      this.options.service = '';\n    }\n    if (typeof pagePath !== 'string') {\n      this.options.pagePath = typeof window !== 'undefined' ? window.location.pathname : '';\n    }\n    if (typeof serviceVersion !== 'string') {\n      this.options.serviceVersion = '';\n    }\n  }\n\n  private validateTags(tags?: TagOption[]): boolean {\n    if (!tags) {\n      return false;\n    }\n    if (!Array.isArray(tags)) {\n      console.warn('customTags must be an array');\n      return false;\n    }\n    const isValid = tags.every(\n      (tag) => tag && typeof tag.key === 'string' && typeof tag.value === 'string'\n    );\n    if (!isValid) {\n      console.warn('customTags format error');\n    }\n    return isValid;\n  }\n\n  getOptions(): Readonly<APMOptions> {\n    return this.options;\n  }\n}\n","import { createLegacyClient } from './core/legacy';\nimport { APMClient } from './core/monitor';\nimport {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n} from './core/types';\n\nconst ClientMonitor = createLegacyClient();\n\nif (typeof window !== 'undefined') {\n  (window as any).ClientMonitor = ClientMonitor;\n}\n\nexport default ClientMonitor;\n\nexport { APMClient };\nexport type {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n};\n","import { APMClient } from './monitor';\nimport {\n  APMOptions,\n  ErrorTrackingOptions,\n  PerformanceTrackingOptions,\n  TraceTrackingOptions,\n  TagOption,\n  VueInstance,\n} from './types';\n\nexport interface LegacyOptions\n  extends APMOptions, ErrorTrackingOptions, PerformanceTrackingOptions, TraceTrackingOptions {\n  vue?: VueInstance;\n}\n\nexport function createLegacyClient() {\n  const client = new APMClient();\n\n  const legacyClient = {\n    customOptions: {} as LegacyOptions,\n\n    register(configs: LegacyOptions): void {\n      this.customOptions = { ...this.customOptions, ...configs };\n      client.init(configs);\n    },\n\n    setPerformance(configs: PerformanceTrackingOptions): void {\n      this.customOptions = { ...this.customOptions, ...configs, useFmp: false };\n      client.updateConfig(this.customOptions);\n      client.trackPerformance(this.customOptions);\n    },\n\n    catchErrors(options: ErrorTrackingOptions): void {\n      const { service, pagePath, serviceVersion, collector } = options;\n      const errorOptions: ErrorTrackingOptions = {\n        ...options,\n        service: service || this.customOptions.service,\n        pagePath: pagePath || this.customOptions.pagePath,\n        serviceVersion: serviceVersion || this.customOptions.serviceVersion,\n        collector: collector || this.customOptions.collector,\n      };\n      client.init(errorOptions);\n    },\n\n    reportFrameErrors(configs: APMOptions, error: Error): void {\n      client.captureError(error, {\n        service: configs.service,\n        pagePath: configs.pagePath,\n        serviceVersion: configs.serviceVersion,\n        collector: configs.collector,\n      });\n    },\n\n    setCustomTags(tags: TagOption[]): void {\n      if (this.validateTags(tags)) {\n        this.customOptions.customTags = tags;\n        client.setCustomTags(tags);\n      }\n    },\n\n    validateTags(customTags?: TagOption[]): boolean {\n      if (!customTags) {\n        return false;\n      }\n      if (!Array.isArray(customTags)) {\n        this.customOptions.customTags = undefined;\n        console.warn('customTags error');\n        return false;\n      }\n      let isValid = true;\n      for (const tag of customTags) {\n        if (!(tag && tag.key && tag.value)) {\n          isValid = false;\n        }\n      }\n      if (!isValid) {\n        this.customOptions.customTags = undefined;\n        console.warn('customTags error');\n      }\n      return isValid;\n    },\n\n    validateOptions(): void {\n      const {\n        collector,\n        service,\n        pagePath,\n        serviceVersion,\n        jsErrors,\n        apiErrors,\n        resourceErrors,\n        autoTracePerf,\n        useFmp,\n        enableSPA,\n        traceSDKInternal,\n        detailMode,\n        noTraceOrigins,\n        traceTimeInterval,\n        vue,\n      } = this.customOptions;\n\n      this.validateTags(this.customOptions.customTags);\n\n      if (typeof collector !== 'string') {\n        this.customOptions.collector = typeof window !== 'undefined' ? window.location.origin : '';\n      }\n      if (typeof service !== 'string') {\n        this.customOptions.service = '';\n      }\n      if (typeof pagePath !== 'string') {\n        this.customOptions.pagePath = typeof window !== 'undefined' ? window.location.pathname : '';\n      }\n      if (typeof serviceVersion !== 'string') {\n        this.customOptions.serviceVersion = '';\n      }\n      if (typeof jsErrors !== 'boolean') {\n        this.customOptions.jsErrors = true;\n      }\n      if (typeof apiErrors !== 'boolean') {\n        this.customOptions.apiErrors = true;\n      }\n      if (typeof resourceErrors !== 'boolean') {\n        this.customOptions.resourceErrors = true;\n      }\n      if (typeof autoTracePerf !== 'boolean') {\n        this.customOptions.autoTracePerf = true;\n      }\n      if (typeof useFmp !== 'boolean') {\n        this.customOptions.useFmp = false;\n      }\n      if (typeof enableSPA !== 'boolean') {\n        this.customOptions.enableSPA = false;\n      }\n      if (typeof traceSDKInternal !== 'boolean') {\n        this.customOptions.traceSDKInternal = false;\n      }\n      if (typeof detailMode !== 'boolean') {\n        this.customOptions.detailMode = true;\n      }\n      if (!Array.isArray(noTraceOrigins)) {\n        this.customOptions.noTraceOrigins = [];\n      }\n      if (typeof traceTimeInterval !== 'number') {\n        this.customOptions.traceTimeInterval = 60000;\n      }\n      if (typeof vue !== 'function') {\n        this.customOptions.vue = undefined;\n      }\n    },\n\n    performance(configs: PerformanceTrackingOptions): void {\n      client.trackPerformance(configs);\n    },\n  };\n\n  return legacyClient;\n}\n"],"names":["generateUUID","replace","c","r","Math","random","toString","ReportService","buildURL","type","collector","ERROR","ERRORS","PERF","SEGMENT","SEGMENTS","sendError","error","url","this","sendByFetch","sendPerformance","perf","sendSegments","segments","_a","service","sendSegmentsByBeacon","sendByBeacon","data","fetch","method","headers","body","JSON","stringify","then","response","status","Error","catch","console","warn","navigator","sendBeacon","Blob","JSErrors","constructor","options","enabled","reportService","enable","window","addEventListener","handleError","bind","disable","removeEventListener","event","errorInfo","uniqueId","serviceVersion","pagePath","category","grade","errorUrl","filename","location","href","message","stack","capture","context","updateConfig","PromiseErrors","handleRejection","reason","_b","AjaxErrors","originalXHROpen","originalXHRSend","interceptXHR","restoreXHR","self","XMLHttpRequest","prototype","open","send","async","username","password","xhr","_apmMethod","_apmUrl","_apmStartTime","Date","now","call","ResourceErrors","target","HTMLScriptElement","src","tagName","HTMLLinkElement","HTMLImageElement","VueErrors","vue","config","errorHandler","_vm","info","ErrorTracker","jsErrors","promiseErrors","ajaxErrors","resourceErrors","vueErrors","apiErrors","PerformanceTracker","track","document","readyState","collectAndReport","once","autoTracePerf","performanceData","timing","performance","useFmp","fmpTime","calculateFMP","XHRInterceptor","_options","FetchInterceptor","TraceTracker","timer","xhrInterceptor","fetchInterceptor","setupReportTimer","setupUnloadHandler","clearReportTimer","clearInterval","setInterval","length","splice","traceTimeInterval","setCustomTags","tags","customTags","APMClient","origin","pathname","errorTracker","performanceTracker","traceTracker","init","validateOptions","enableSPA","captureError","trackPerformance","validateTags","Array","isArray","isValid","every","tag","key","value","getOptions","ClientMonitor","client","customOptions","register","configs","setPerformance","catchErrors","errorOptions","reportFrameErrors","traceSDKInternal","detailMode","noTraceOrigins","createLegacyClient"],"mappings":"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"}